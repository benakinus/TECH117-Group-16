<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Heart Rate Monitor</title>

  <!-- Prism.js syntax highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"></script>

  <!-- Includes the stylesheet file styles.css -->
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <!-- Fixed Navigation Menu -->
  <nav id="menu">
    <h3>Menu</h3>
    <ul>
      <li><a href="#top">Title</a></li>
      <li><a href="#information">Project Information</a></li>
      <li><a href="#introduction">Introduction</a></li>
      <li><a href="#circuit-diagram">Circuit</a></li>
      <li><a href="#environment">Environment</a></li>
      <li><a href="#bom">BoM</a></li>
      <li><a href="#prototype">Prototype</a></li>
      <li><a href="#code">Code</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      <li><a href="#references">References</a></li>
    </ul>
  </nav>


  <h1 id="top">Heart Rate Monitor</h1>

  <section id="information">
    <h2>Project Information</h2>
    <p><strong>Course:</strong> TECH 117 (Computer Engineering Technology, Fall 2025)</p>
    <p><strong>Instructor:</strong> Ph.D. Ana Rodrigues</p>
    <p><strong>Team Members:</strong></p>
    <ul>
      <li>Benjamin Akinnusi</li>
      <li>Maliek Meggoe</li>
      <li>Oghenetejiri Morgan-Oloyeh</li>
      <li>Martins Ola</li>
    </ul>
  </section>

  <section id="introduction">
    <h2>Introduction</h2>
    <p>This project uses an <strong>Arduino Uno, a KY-039 pulse sensor, an LCD display, Red and Green LEDS and a potentiometer</strong>, 
       to detect and display heart rate in real-time. The system processes the heart's electrical signals via
       the pulse sensor and displays them on the LCD display for easy monitoring. A cover is used over the KY-039 Sensor to help limit interference from outside light, as it is light sensitive.
    </p>
  </section>

  <section id="circuit-diagram">
    <h2>Circuit Diagram</h2>
    <p>The KY-039 sensor will measure the pulse coming from the fingertip of a user and will display the heart rate
      on a LCD display in the form of <strong>Beats Per Minute</strong>. The completed diagram is a combination of both diagrams.
    </p>
    <img src="KY-039.png" alt="Arduino collision warning system">
    <img src="Test 1.png" alt="Arduino collision warning system">
  </section>

  <section id="environment">
    <h2>Environmental Impact Assessment</h2>
    <ul>
      <li><strong>Materials:</strong> The Arduino Uno is RoHS and WEEE compliant, limiting hazardous substances.All components have a low environmental impact. The cover of the KY-039 sensor is made of a material that can be easily recycled.
      </li>
      <li><strong>Energy Efficiency:</strong> The circuit draws minimal power (~50 mA at 5V), ideal for USB or
        solar power. In our case we used both USB and battery power.</li>
      <li><strong>Reusability:</strong> All components are modular and reusable, reducing electronic waste. All of the components can be recycled.</li>
      <li><strong>Packaging & Shipping:</strong> Ordering all components from a single supplier helps minimize
        carbon footprint.</li>
    </ul>
  </section>

  <section id="bom">
    <h2>Bill of Materials (BoM)</h2>
    <table>
      <thead>
        <tr>
          <th>Item</th>
          <th>Qty</th>
          <th>Unit Price (CAD)</th>
          <th>Subtotal (CAD)</th>
          <th>Source</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Arduino Uno Rev3</td>
          <td>1</td>
          <td>$21.99</td>
          <td>$21.99</td>
          <td><a href="https://www.amazon.ca/PTSolns-ATmega328P-Microcontroller-Development-Compatible/dp/B0DT2DVP7C/ref=sr_1_2_sspa">Arduino Store</a></td>
        </tr>
        <tr>
          <td>KY-039 Pulse Sensor (Pack of 3)</td>
          <td>1</td>
          <td>$2.99</td>
          <td>$8.99</td>
          <td><a href="https://www.amazon.ca/KY-039-Finger-Heartbeat-Measurement-Arduino/dp/B07S8N69DK/ref=sr_1_1">Amazon</a></td>
        </tr>
        <tr>
          <td>16x2 LCD Arduino Display</td>
          <td>1</td>
          <td>$10.36</td>
          <td>$10.36</td>
          <td><a href="https://www.amazon.ca/Freenove-Display-Compatible-Arduino-Raspberry/dp/B0B76YGDV4/ref=sr_1_5?th=1">Amazon</a></td>
        </tr>
        <tr>
          <td>LEDs (Red, Yellow, Green)</td>
          <td>3</td>
          <td>$0.05</td>
          <td>$0.15</td>
          <td><a href="https://www.digikey.ca/en/products/detail/everlight-electronics-co-ltd/HLMPD150A/2675555">DigiKey</a></td>
        </tr>
        <tr>
          <td>220 Ω Resistors</td>
          <td>3</td>
          <td>$0.03</td>
          <td>$0.09</td>
          <td>Adafruit</td>
        </tr>
        <tr>
          <td>Breadboard</td>
          <td>1</td>
          <td>$5.00</td>
          <td>$5.00</td>
          <td><a href="https://www.amazon.ca/MMOBIEL-Solderless-Breadboards-Prototype-Circuit/dp/B0CPJP9YSN/ref=sr_1_23">Amazon</a></td>
        </tr>
        <tr>
          <td>Jumper Wires</td>
          <td>1 set</td>
          <td>$3.50</td>
          <td>$3.50</td>
          <td><a href="https://www.sparkfun.com/jumper-wires-standard-7-m-m-30-awg-30-pack.html">SparkFun</a>
          </td>
        </tr>
        <tr>
          <td>USB Cable</td>
          <td>1 </td>
          <td>$3.50</td>
          <td>$3.50</td>
          <td><a href="https://www.sparkfun.com/jumper-wires-standard-7-m-m-30-awg-30-pack.html">SparkFun</a>
          </td>
        </tr>
        <tr>
          <td>Potentiometer</td>
          <td>1 </td>
          <td>$1.66</td>
          <td>$9.98</td>
          <td><a href="https://www.amazon.ca/Gikfun-Knurled-Linear-Potentiometer-Arduino/dp/B0146DJWFU/ref=sr_1_11?dib=eyJ2IjoiMSJ9.7jvyYvuEpUg_Q9CSZ-lKvSUqchi9CxNWD1rc9WbYzdrtfu_CA-KzsPHRNEKRgJk-T8-DnuYBLdve6WFvyk1v4irY_CCOfvWrwFNkIgL7u3XMboXDuqhYyZqj37KZkjXvXbpVhi-h-HYqU3uSMHGCeSH3tPa8Ug7iwHUgwPjfoVtOkU_CwJLx1q5iXPJdDllxCeTcj2GU7_Fem2bpPjl9jbFMgxWS0KCXHkgGHF0ttw40J-ogD9ZzfwUGIYpfrZbUjiGxJZAzhJj47kmguf7x33Hw9iqSjzkZhL6xo1F0h1U.0qWzpfyFZ4CokiSi5BTVVaat9FZ1_NPB3Y7HgwO7toc&dib_tag=se&keywords=arduino+potentiometer&qid=1765320492&sr=8-11">Amazon</a>
          </td>
        </tr>
      </tbody>
      <tfoot>
        <tr>
          <td colspan="3">Estimated Total</td>
          <td>$63.56</td>
          <td>—</td>
        </tr>
      </tfoot>
    </table>
  </section>

  <section id="prototype">
    <h2>Prototype</h2>
    <p>The following image shows the assembled prototype on a breadboard.</p>
    <img src="CompleteProto.jpg" alt="Heart Rate monitor prototype">
    <p>The following image shows the KY-039 pulse sensor with a cover to linit the amount of light that goes on the sensor.</p>
    <img src="KYSensor Cup.jpg" alt="KY Sensor Cup">
  </section>

  <section id="code">
    <h2>Arduino Code</h2>
    <p>The following Arduino code detects the pulse from a fingertip, converts it to BPM, and prints it on to the Serial Monitor and the LCD Display</p>

    <pre class="line-numbers">
  <button class="copy-btn" onclick="copyCode()">Copy</button>
  <code id="arduinoCode" class="language-cpp">

#define samp_siz 4
#define rise_threshold 4

#include <LiquidCrystal.h>

const int rs = 12, en = 11, d4 = 5, d5 = 4, d6 = 3, d7 = 2;
LiquidCrystal lcd(rs, en, d4, d5, d6, d7);

int sensorPin = A0;

const int redLED = 6;
const int yellowLED = 7;
const int greenLED = 13; 

byte heart[] = {
  B00000,
  B00000,
  B11011,
  B11111,
  B11111,
  B01110,
  B00100,
  B00000
};

void setup() {
    lcd.begin(16, 2);
    // Turn on the display
    lcd.display();
    // Load custom character into memory slot 0
    lcd.createChar(0, heart);
    Serial.begin(9600);
    lcd.print("Heart Monitor");
    pinMode(redLED, OUTPUT);
    pinMode(yellowLED, OUTPUT);
    pinMode(greenLED, OUTPUT);

    
}

void loop() {

    float reads[samp_siz];
    float sum = 0;

    long int now, ptr = 0;
    float last = 0, reader = 0, start = 0;
    float first = 0, second = 0, third = 0;
    float before = 0;
    float print_value = 0;

    bool rising = false;
    int rise_count = 0;

    long int last_beat = millis();   // initialize properly

    // Initialize array
    for (int i = 0; i < samp_siz; i++)
        reads[i] = 0;

    while (1) {

        // Average over ~20ms to remove 50Hz noise
        int n = 0;
        reader = 0;
        start = millis();

        do {
            reader += analogRead(sensorPin);

            
        
            n++;
            now = millis();
        } while (now < start + 20);

        reader /= n;

      //Serial.print("reader = ");
            //Serial.println(reader);
            
           
        // Rolling average buffer
        sum -= reads[ptr];
        sum += reader;
        reads[ptr] = reader;
        last = sum / samp_siz;

        // Detect rising edge (heartbeat)
        if (last > before) {
            rise_count++;

            if (!rising && rise_count > rise_threshold) {
                rising = true;

                first = millis() - last_beat;
                last_beat = millis();

                // Avoid divide-by-zero
                if (first < 1) first = 1;

                // Weighted BPM average
                print_value = 60000.0 /
                    (0.4 * first + 0.3 * second + 0.3 * third);

              int bpm = round(print_value); 
              if (bpm > 100) {
                digitalWrite(redLED, HIGH);
                digitalWrite(yellowLED, LOW);
                digitalWrite(greenLED, LOW);
              }
              else if (bpm<= 100 && bpm >= 70) {
                digitalWrite(redLED, LOW);
                digitalWrite(yellowLED, LOW);
                digitalWrite(greenLED, HIGH);
              }
              else { 
                digitalWrite(redLED, LOW);
                digitalWrite(yellowLED, HIGH);
                digitalWrite(greenLED, LOW);
              }
              lcd.clear();
              lcd.print("Heart Monitor");
                lcd.setCursor(0, 1);
                lcd.print("BPM:");
                lcd.print(bpm);
              
               lcd.setCursor(10,1);
              lcd.print(byte(0));
            delay(100);
        lcd.setCursor(10,1);
            lcd.print(' ');
            lcd.write(byte(0));
            delay(100);

              
                Serial.print(" Print Value: ");
                Serial.println(print_value);

              Serial.print(" BPM : ");
              Serial.println(bpm);
                // Shift beat memory
                third = second;
                second = first;
            }

        } else {
            // Falling edge
            rising = false;
            rise_count = 0;
        }

        before = last;

        // Move circular buffer pointer
        ptr = (ptr + 1) % samp_siz;
    }
}


    </code></pre>

    <script>
      function copyCode() {
        const code = document.getElementById('arduinoCode').innerText;
        navigator.clipboard.writeText(code).then(() => {
          alert('Code copied to clipboard!');
        });
      }
    </script>
  </section>



  <section id="conclusion">
    <h2>Conclusion</h2>
    <p>The system is able to detect a pulse of a fingertip and display the BPM on to the LCD display. The pulse is able to be
      detected by the KY-039 sensor. The Red LED lights up if BPM is over 100 BPM, the green LED lights if if between 70-100 BPM
      and the yellow LED lights up if under 70 BPM.
    </p>
  </section>

 <section id="references">
  <h2>References</h2>
  <p>
    The following external resources and example projects demonstrate related Arduino applications 
    using ultrasonic distance sensors, passive buzzers, and multicolour LEDs:
  </p>

  <ul>
    <li>
      Arduino Project Hub. (2018, April 1). 
      <em>From KY-039 to heart rate.</em> 
      Arduino Project Hub. 
      <a href="https://projecthub.arduino.cc/Johan_Ha/from-ky-039-to-heart-rate-8c660b" target="_blank" rel="noopener noreferrer">
        https://projecthub.arduino.cc/Johan_Ha/from-ky-039-to-heart-rate-8c660b
      </a>
    </li>

    <li>
      Phipps Electronics. (2021, March 1). 
      <em>Using the heart beat sensor KY-039 with Arduino</em> 
      Arduino Project Hub. 
      <a href="https://www.phippselectronics.com/using-the-heart-beat-sensor-ky-039-with-arduino/" target="_blank" rel="noopener noreferrer">
        https://www.phippselectronics.com/using-the-heart-beat-sensor-ky-039-with-arduino/
      </a>
    </li>

    <li>
      Last Minute Engineers.(2025, May 29). 
      <em>In-depth: Detect, Measure & Plot Heart Rate Using Pulse Sensor & Arduino..</em> 
      Last Minute Engineers. 
      <a href="https://lastminuteengineers.com/pulse-sensor-arduino-tutorial/ " target="_blank" rel="noopener noreferrer">
        https://lastminuteengineers.com/pulse-sensor-arduino-tutorial/ 
      </a>
    </li>

    <li>
       Arduino Project Hub. (2022, July 11). 
      <em>Arduino DIY Potentiometer Value Display on LCD 16x2.</em> 
      Arduino Project Hub. 
      <a href="https://projecthub.arduino.cc/krishna_agarwal/arduino-diy-potentiometer-value-display-on-lcd-16x2-899f16" target="_blank" rel="noopener noreferrer">
        https://projecthub.arduino.cc/krishna_agarwal/arduino-diy-potentiometer-value-display-on-lcd-16x2-899f16
      </a>
    </li>

    <li>
       Mayo Clinic. (2025, October 22). 
      <em>2 easy, accurate ways to measure your heart rate.</em> 
      Mayo Clinic. 
      <a href="https://www.mayoclinic.org/healthy-lifestyle/fitness/expert-answers/heart-rate/faq-20057979#:~:text=A%20normal%20resting%20heart%20rate%20ranges%20from%2060%20to%20100,pump%20blood%20through%20the%20body." target="_blank" rel="noopener noreferrer">
        https://www.mayoclinic.org/healthy-lifestyle/fitness/expert-answers/heart-rate/faq-20057979#:~:text=A%20normal%20resting%20heart%20rate%20ranges%20from%2060%20to%20100,pump%20blood%20through%20the%20body.
      </a>
    </li>
  </ul>
</section>



</body>

</html>
